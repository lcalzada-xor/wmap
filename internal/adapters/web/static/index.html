<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WMAP // Enterprise WiFi Intel</title>

    <!-- Fonts (iOS 19 Style) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@400;600;700&display=swap"
        rel="stylesheet">

    <!-- Icons & Libs -->
    <link rel="stylesheet" href="fontawesome-css/all.min.css">
    <script type="text/javascript" src="js/vis-network.min.js"></script>

    <!-- App Styles -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- Visualization Layers -->
    <canvas id="heatmap-layer"></canvas>
    <div id="mynetwork"></div>
    <canvas id="radar-layer"></canvas>

    <!-- Dynamic Island (iOS Status Bar) -->
    <div id="dynamic-island-container">
        <div id="dynamic-island" class="glass">
            <div id="island-content">
                <i class="fas fa-wifi"></i>
                <span id="status">INITIALIZING...</span>
            </div>
        </div>
    </div>

    <!-- User Controls -->
    <div id="user-controls"
        style="position: absolute; top: 20px; right: 20px; z-index: 1000; display: flex; gap: 12px; align-items: center;">

        <!-- User Badge -->
        <span id="current-user" class="glass"
            style="height: 40px; padding: 0 16px; border-radius: 20px; font-size: 0.9em; color: var(--accent-color); border: 1px solid rgba(0, 240, 255, 0.2); display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-user-circle"></i> <span id="username-display" style="font-weight: 600;">Loading...</span>
        </span>

        <!-- Vulnerability Panel Button -->
        <button id="btn-show-vulns" class="glass" title="Vulnerabilities"
            style="width: 40px; height: 40px; padding: 0; border-radius: 50%; border: 1px solid rgba(255, 149, 0, 0.4); color: #ff9500; cursor: pointer; backdrop-filter: blur(10px); background: rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center;">
            <i class="fas fa-shield-virus"></i>
        </button>

        <!-- Audit Log Button -->
        <button id="btn-show-audit" class="glass" title="Audit Logs"
            style="width: 40px; height: 40px; padding: 0; border-radius: 50%; border: 1px solid rgba(255, 255, 255, 0.2); color: #fff; cursor: pointer; backdrop-filter: blur(10px); background: rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center;">
            <i class="fas fa-history"></i>
        </button>

        <!-- Logout Button -->
        <button id="btn-logout" class="glass" title="Logout"
            style="width: 40px; height: 40px; padding: 0; border-radius: 50%; border: 1px solid rgba(255, 59, 48, 0.4); color: #ff3b30; cursor: pointer; backdrop-filter: blur(10px); background: rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center;">
            <i class="fas fa-sign-out-alt"></i>
        </button>
    </div>

    <!-- Main HUD Panel -->
    <div class="hud-panel info-panel glass">
        <h3>WMAP Intel</h3>

        <!-- Advanced Search Module -->
        <div class="search-module">
            <!-- Search Bar with Autocomplete -->
            <div class="search-bar-advanced">
                <i class="fas fa-search"></i>
                <input type="text" id="node-search" placeholder="Search MAC, SSID, Vendor, Alias..." autocomplete="off">
                <button id="btn-clear-search" class="icon-btn" title="Clear">
                    <i class="fas fa-times"></i>
                </button>
                <button id="btn-toggle-filters" class="icon-btn" title="Advanced Filters">
                    <i class="fas fa-sliders-h"></i>
                    <span class="badge" id="active-filters-count">0</span>
                </button>
            </div>

            <!-- Autocomplete Dropdown -->
            <div id="search-suggestions" class="suggestions-dropdown">
                <!-- Populated by JS -->
            </div>

            <!-- Active Filter Tags -->
            <div id="filter-tags" class="filter-tags">
                <!-- Chips dinámicos: "WPA2 ×", "5GHz ×", etc. -->
            </div>
        </div>

        <!-- Advanced Filters Panel (Collapsible) -->
        <div id="advanced-filters-panel" class="advanced-filters glass" style="display:none;">

            <!-- Quick Presets -->
            <div class="filter-section">
                <h4><i class="fas fa-bolt"></i> Quick Filters</h4>
                <div class="preset-buttons">
                    <!-- Populated by FilterUI -->
                </div>
            </div>

            <!-- Security Filter -->
            <div class="filter-section">
                <h4><i class="fas fa-shield-alt"></i> Security</h4>
                <div class="checkbox-group">
                    <label><input type="checkbox" class="filter-security" value="WPA3"> WPA3</label>
                    <label><input type="checkbox" class="filter-security" value="WPA2"> WPA2</label>
                    <label><input type="checkbox" class="filter-security" value="WEP"> WEP</label>
                    <label><input type="checkbox" class="filter-security" value="OPEN"> Open</label>
                </div>
            </div>

            <!-- Vulnerabilities Filter -->
            <div class="filter-section">
                <h4><i class="fas fa-bug"></i> Vulnerabilities</h4>
                <div class="checkbox-group">
                    <label><input type="checkbox" class="filter-vulnerability" value="WEP"> WEP Aircrack</label>
                    <label><input type="checkbox" class="filter-vulnerability" value="WPS"> WPS Pixie</label>
                    <label><input type="checkbox" class="filter-vulnerability" value="KRACK"> KRACK</label>
                    <label><input type="checkbox" class="filter-vulnerability" value="DRAGON"> Dragonblood</label>
                </div>
            </div>

            <!-- Frequency Filter -->
            <div class="filter-section">
                <h4><i class="fas fa-broadcast-tower"></i> Frequency</h4>
                <div class="checkbox-group">
                    <label><input type="checkbox" class="filter-frequency" value="2.4"> 2.4 GHz</label>
                    <label><input type="checkbox" class="filter-frequency" value="5"> 5 GHz</label>
                </div>
            </div>

            <!-- Channel Filter -->
            <div class="filter-section">
                <h4><i class="fas fa-hashtag"></i> Channels</h4>
                <select id="filter-channels" multiple class="multi-select"
                    style="width: 100%; min-height: 80px; padding: 8px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">
                    <!-- Populated dynamically from detected channels -->
                </select>
                <div style="display: flex; gap: 8px; margin-top: 8px;">
                    <button id="btn-select-common-24" class="action-btn-secondary"
                        style="flex: 1; padding: 6px; font-size: 0.8em;">
                        <i class="fas fa-check"></i> 1,6,11
                    </button>
                    <button id="btn-clear-channels" class="action-btn-secondary"
                        style="flex: 1; padding: 6px; font-size: 0.8em;">
                        <i class="fas fa-times"></i> Clear
                    </button>
                </div>
            </div>

            <!-- Vendor Filter -->
            <div class="filter-section">
                <h4><i class="fas fa-industry"></i> Vendor</h4>
                <select id="filter-vendor" multiple class="multi-select">
                    <!-- Populated dynamically from detected vendors -->
                </select>
            </div>

            <!-- Advanced Status -->
            <div class="filter-section">
                <h4><i class="fas fa-microchip"></i> Target Status</h4>
                <div class="checkbox-group">
                    <label><input type="checkbox" class="filter-boolean" value="hasHandshake"> <i class="fas fa-key"
                            style="color:var(--warning-color); margin-right:5px"></i> Has Handshake</label>
                    <label><input type="checkbox" class="filter-boolean" value="hiddenSSID"> <i class="fas fa-eye-slash"
                            style="color:var(--text-secondary); margin-right:5px"></i> Hidden SSID</label>
                    <label><input type="checkbox" class="filter-boolean" value="wpsActive"> <i class="fas fa-lock-open"
                            style="color:var(--success-color); margin-right:5px"></i> WPS Active</label>
                    <label><input type="checkbox" class="filter-boolean" value="randomizedMac"> <i class="fas fa-random"
                            style="color:var(--accent-color); margin-right:5px"></i> Randomized MAC</label>
                </div>
            </div>

            <!-- Signal Range -->
            <div class="filter-section">
                <h4><i class="fas fa-signal"></i> Signal Range</h4>
                <div class="range-inputs">
                    <input type="number" id="rssi-min" value="-100" min="-100" max="0" placeholder="Min">
                    <span>to</span>
                    <input type="number" id="rssi-max" value="0" min="-100" max="0" placeholder="Max">
                    <span>dBm</span>
                </div>
            </div>

            <!-- Time Range -->
            <div class="filter-section">
                <h4><i class="fas fa-clock"></i> Activity Time</h4>
                <div class="form-group">
                    <label>Last Seen:</label>
                    <select id="time-range-preset"
                        style="width: 100%; padding: 8px; margin-top: 4px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">
                        <option value="">Any time</option>
                        <option value="5m">Last 5 minutes</option>
                        <option value="15m">Last 15 minutes</option>
                        <option value="1h">Last hour</option>
                        <option value="24h">Last 24 hours</option>
                        <option value="custom">Custom Range...</option>
                    </select>
                </div>
            </div>

            <!-- Traffic Filter -->
            <div class="filter-section">
                <h4><i class="fas fa-exchange-alt"></i> Traffic</h4>
                <div class="traffic-inputs">
                    <label>Min TX: <input type="number" id="traffic-min-tx" placeholder="0 bytes"></label>
                    <label>Min RX: <input type="number" id="traffic-min-rx" placeholder="0 bytes"></label>
                    <label>Min Packets: <input type="number" id="traffic-min-packets" placeholder="0"></label>
                </div>
            </div>

            <!-- Actions -->
            <div class="filter-actions">
                <button id="btn-reset-filters" class="action-btn-secondary">
                    <i class="fas fa-undo"></i> Reset All
                </button>
                <button id="btn-save-preset" class="action-btn-secondary">
                    <i class="fas fa-save"></i> Save Preset
                </button>
            </div>
        </div>

        <div class="control-group">
            <label><input type="checkbox" id="filter-ap" checked> Show Access Points</label>
            <label><input type="checkbox" id="filter-sta" checked> Show Stations</label>

            <!-- RSSI Filter (Legacy) -->
            <div style="margin-top: 15px; margin-bottom:15px;">
                <label for="rssi-slider"
                    style="font-size:0.9em; color:var(--accent-color); display:flex; justify-content:space-between; margin-bottom:5px;">
                    <span>Min Signal:</span> <span id="rssi-val" style="font-weight:bold">-100</span> dBm
                </label>
                <input type="range" id="rssi-slider" min="-100" max="-30" value="-100" step="5" style="width:100%">
            </div>

            <div style="margin-top: 10px; border-top: 1px dashed rgba(255,255,255,0.1); padding-top: 10px;">
                <label><input type="checkbox" id="toggle-grid" checked> <i class="fas fa-border-all"
                        style="margin-right:8px"></i> Tactical Grid</label>
                <label><input type="checkbox" id="toggle-trails" checked> <i class="fas fa-wind"
                        style="margin-right:8px"></i> Motion Trails</label>
                <label><input type="checkbox" id="toggle-heatmap"> <i class="fas fa-fire-alt"
                        style="margin-right:8px"></i> Signal Heatmap</label>
                <label><input type="checkbox" id="toggle-clustering"> <i class="fas fa-project-diagram"
                        style="margin-right:8px"></i> Group Stations</label>
                <label><input type="checkbox" id="toggle-physics" checked> <i class="fas fa-atom"
                        style="margin-right:8px"></i> Physics Engine</label>
                <label><input type="checkbox" id="toggle-persist" checked> <i class="fas fa-history"
                        style="margin-right:8px"></i> Persist Findings</label>
            </div>

            <!-- Session Management -->
            <div style="margin-top: 20px; border-top: 1px solid var(--panel-border); padding-top: 15px;">
                <h4
                    style="font-size: 0.75em; color:var(--text-secondary); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
                    WORKSPACE MGMT</h4>
                <div style="display:flex; gap:10px; margin-bottom:10px;">
                    <button id="btn-health-monitor" class="action-btn-secondary"
                        style="flex:1; padding:10px; cursor:pointer; font-size:0.9em;">
                        <i class="fas fa-heartbeat"></i> Health
                    </button>
                    <button id="btn-export-report" class="action-btn-secondary"
                        style="flex:1; padding:10px; cursor:pointer; font-size:0.9em;">
                        <i class="fas fa-file-contract"></i> Reports
                    </button>
                    <button id="btn-clear-workspace" class="action-btn-secondary"
                        style="flex:1; padding:10px; cursor:pointer; font-size:0.9em; color: var(--danger-color); border-color: rgba(255, 59, 48, 0.3);">
                        <i class="fas fa-trash-alt"></i> Clear
                    </button>
                </div>
            </div>

            <!-- Channel Selection Button -->
            <div style="margin-top: 20px; border-top: 1px solid var(--panel-border); padding-top: 15px;">
                <button id="btn-channel-config" class="action-btn-secondary"
                    style="width:100%; padding:10px; cursor:pointer; font-size:0.9em;">
                    <i class="fas fa-broadcast-tower"></i> Channel Configuration
                </button>
            </div>

            <!-- Deauth Attack Toggle -->
            <div style="margin-top: 10px;">
                <button id="btn-toggle-deauth" class="action-btn-secondary"
                    style="width:100%; padding:10px; cursor:pointer; font-size:0.9em; background: rgba(255, 69, 58, 0.15); border: 1px solid rgba(255, 69, 58, 0.3); color: var(--danger-color);">
                    <i class="fas fa-bolt"></i> Deauth Visualizer
                </button>
            </div>

            <!-- WPS Pixie Dust Toggle -->
            <div style="margin-top: 5px;">
                <button id="btn-toggle-wps" class="action-btn-secondary"
                    style="width:100%; padding:10px; cursor:pointer; font-size:0.9em; background: rgba(255, 179, 0, 0.15); border: 1px solid rgba(255, 179, 0, 0.3); color: var(--warning-color);">
                    <i class="fas fa-magic"></i> Pixie Dust Attack
                </button>
            </div>

            <!-- MDK Auth Flood Toggle -->
            <div style="margin-top: 5px;">
                <button id="btn-toggle-auth-flood" class="action-btn-secondary"
                    style="width:100%; padding:10px; cursor:pointer; font-size:0.9em; background: rgba(180, 0, 255, 0.15); border: 1px solid rgba(180, 0, 255, 0.3); color: #c300ff;">
                    <i class="fas fa-ghost"></i> Auth Flood (MDK)
                </button>
            </div>

            <button id="btn-active-scan" class="action-btn"
                style="width:100%; margin-top:15px; background:var(--danger-color); color:white; border:none; padding:12px; cursor:pointer; font-family:var(--font-head);">
                <i class="fas fa-radar"></i> ACTIVE SCAN
            </button>
        </div>

        <div style="border-top: 1px solid var(--panel-border); padding-top: 20px; margin-top: 20px;">
            <div class="legend-item">
                <span class="legend-icon" style="color:var(--accent-color)"><i class="fas fa-server"></i></span> Network
            </div>
            <div class="legend-item">
                <span class="legend-icon" style="color:var(--success-color)"><i class="fas fa-wifi"></i></span>
                Access Point (<span id="stat-ap">0</span>)
            </div>
            <div class="legend-item">
                <span class="legend-icon" style="color:var(--danger-color)"><i
                        class="fas fa-mobile-screen-button"></i></span>
                Station (<span id="stat-sta">0</span>)
            </div>
        </div>
    </div>

    <!-- Node Details Side Panel -->


    <!-- Zoom/Nav Controls -->
    <div class="zoom-controls">
        <button id="zoom-in" class="zoom-btn" title="Zoom In"><i class="fas fa-plus"></i></button>
        <button id="zoom-fit" class="zoom-btn" title="Fit All"><i class="fas fa-compress-arrows-alt"></i></button>
        <button id="zoom-out" class="zoom-btn" title="Zoom Out"><i class="fas fa-minus"></i></button>
    </div>

    <!-- Custom Modal (for Alias) -->
    <div id="custom-modal" class="custom-modal">
        <div class="modal-content">
            <h3 id="modal-title">TITLE</h3>
            <input type="text" id="modal-input" placeholder="Enter value...">
            <div class="modal-buttons">
                <button id="btn-modal-cancel">Cancel</button>
                <button id="btn-modal-confirm">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Workspace Selection Modal -->
    <div id="workspace-modal" class="custom-modal" style="background: rgba(0,0,0,0.85); backdrop-filter: blur(10px);">
        <div class="modal-content"
            style="border: 1px solid var(--accent-color); box-shadow: 0 0 20px rgba(0, 240, 255, 0.2);">
            <h3
                style="margin-bottom: 20px; color: var(--accent-color); font-family: var(--font-head); letter-spacing: 1px;">
                <i class="fas fa-database"></i> SELECT WORKSPACE
            </h3>

            <div style="margin-bottom: 25px;">
                <label style="display:block; margin-bottom:10px; font-size:0.9em; color:var(--text-secondary);">Load
                    Existing Workspace</label>
                <div style="display: flex; gap: 10px;">
                    <select id="workspace-select"
                        style="flex: 1; padding: 10px; background: rgba(255,255,255,0.1); border: 1px solid var(--panel-border); color: white; border-radius: 6px;">
                        <option value="">-- Select Workspace --</option>
                    </select>
                    <button id="btn-workspace-load" class="action-btn" style="padding: 10px 20px;">LOAD</button>
                </div>
            </div>

            <div style="position: relative; margin: 20px 0; border-top: 1px dashed rgba(255,255,255,0.2);">
                <span
                    style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); background: #000; padding: 0 10px; color: var(--text-secondary); font-size: 0.8em;">OR</span>
            </div>

            <div>
                <label style="display:block; margin-bottom:10px; font-size:0.9em; color:var(--text-secondary);">Create
                    New Workspace</label>
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="workspace-new-name" placeholder="Enter workspace name..."
                        style="flex: 1; padding: 10px; background: rgba(255,255,255,0.1); border: 1px solid var(--panel-border); color: white; border-radius: 6px;">
                    <button id="btn-workspace-create" class="action-btn-secondary"
                        style="padding: 10px 20px; background: var(--success-color); color: black; border: none;">CREATE</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Area -->
    <div id="notification-area"></div>

    <!-- Channel Configuration Modal -->
    <div id="channel-modal" class="custom-modal">
        <div class="modal-content" style="max-width: 600px; max-height: 80vh; overflow-y: auto;">
            <h3 style="margin-bottom: 20px;">
                <i class="fas fa-broadcast-tower"></i> Channel Configuration
            </h3>

            <div style="margin-bottom: 20px; display: flex; gap: 10px;">
                <button id="btn-select-all-channels" class="action-btn-secondary" style="flex: 1; padding: 10px;">
                    <i class="fas fa-check-double"></i> Select All
                </button>
                <button id="btn-select-none-channels" class="action-btn-secondary" style="flex: 1; padding: 10px;">
                    <i class="fas fa-times"></i> Clear All
                </button>
            </div>

            <!-- 2.4 GHz Channels -->
            <div style="margin-bottom: 25px;">
                <h4 style="font-size: 0.9em; color: var(--accent-color); margin-bottom: 12px; font-weight: 600;">
                    <i class="fas fa-wifi"></i> 2.4 GHz Channels (1-13)
                </h4>
                <div id="channels-24ghz" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px;">
                    <!-- Channels 1-13 will be populated by JS -->
                </div>
            </div>

            <!-- 5 GHz Channels -->
            <div style="margin-bottom: 25px;">
                <h4 style="font-size: 0.9em; color: var(--accent-color); margin-bottom: 12px; font-weight: 600;">
                    <i class="fas fa-signal"></i> 5 GHz Channels
                </h4>

                <div style="margin-bottom: 15px;">
                    <div style="font-size: 0.75em; color: var(--text-secondary); margin-bottom: 6px;">UNII-1 (36-48)
                    </div>
                    <div id="channels-5ghz-unii1"
                        style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 12px;">
                        <!-- 36, 40, 44, 48 -->
                    </div>
                </div>

                <div style="margin-bottom: 15px;">
                    <div style="font-size: 0.75em; color: var(--text-secondary); margin-bottom: 6px;">UNII-2 (52-64)
                    </div>
                    <div id="channels-5ghz-unii2"
                        style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 12px;">
                        <!-- 52, 56, 60, 64 -->
                    </div>
                </div>

                <div style="margin-bottom: 15px;">
                    <div style="font-size: 0.75em; color: var(--text-secondary); margin-bottom: 6px;">UNII-2 Extended
                        (100-140)</div>
                    <div id="channels-5ghz-unii2ext"
                        style="display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; margin-bottom: 12px;">
                        <!-- 100-140 -->
                    </div>
                </div>

                <div>
                    <div style="font-size: 0.75em; color: var(--text-secondary); margin-bottom: 6px;">UNII-3 (149-165)
                    </div>
                    <div id="channels-5ghz-unii3"
                        style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px;">
                        <!-- 149, 153, 157, 161, 165 -->
                    </div>
                </div>
            </div>

            <div class="modal-buttons">
                <button id="btn-channel-modal-close">Close</button>
            </div>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="context-menu" class="context-menu">
        <div class="menu-item" data-action="focus"><i class="fas fa-crosshairs"></i> Focus Node</div>
        <div class="menu-item" data-action="alias"><i class="fas fa-tag"></i> Rename / Alias</div>
        <div class="menu-item" data-action="copy"><i class="fas fa-copy"></i> Copy MAC</div>
        <div class="menu-item" data-action="details"><i class="fas fa-info-circle"></i> Details</div>
        <div class="menu-item" data-action="deauth"><i class="fas fa-bolt"></i> Deauth Attack</div>
        <div class="menu-item" data-action="wps-attack"><i class="fas fa-magic"></i> Pixie Dust Attack</div>
    </div>

    <!-- App Logic -->
    <script src="js/auth.js?v=2"></script>
    <script type="module" src="js/main.js?v=2"></script>

    <!-- Audit Logs Modal -->
    <div id="audit-modal" class="custom-modal">
        <div class="modal-content" style="max-width: 900px; max-height: 80vh; overflow-y: auto;">
            <h3 style="margin-bottom: 20px; color: var(--accent-color);">
                <i class="fas fa-history"></i> System Audit Logs
            </h3>

            <div id="audit-loading" style="text-align: center; padding: 20px; display: none;">
                <i class="fas fa-spinner fa-spin fa-2x"></i>
            </div>

            <div class="table-container" style="overflow-x: auto;">
                <table id="audit-table" style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                    <thead>
                        <tr style="border-bottom: 1px solid var(--panel-border); text-align: left;">
                            <th style="padding: 10px;">Timestamp</th>
                            <th style="padding: 10px;">User</th>
                            <th style="padding: 10px;">Action</th>
                            <th style="padding: 10px;">Target</th>
                            <th style="padding: 10px;">Details</th>
                        </tr>
                    </thead>
                    <tbody id="audit-list">
                        <!-- Populated via JS -->
                    </tbody>
                </table>
            </div>

            <button id="btn-refresh-audit" class="action-btn-secondary" style="margin-right: 10px;">
                <i class="fas fa-sync"></i> Refresh
            </button>
            <button id="btn-close-audit" class="action-btn-secondary"
                style="background: rgba(255,255,255,0.1);">Close</button>
        </div>
    </div>

    <!-- WPS Pixie Dust Panel -->
    <div id="wps-panel" class="hud-panel wps-panel glass">
        <h3><i class="fas fa-magic"></i> Pixie Dust Attack <i class="fas fa-times" id="btn-close-wps"
                style="float:right; cursor:pointer; opacity:0.6; font-size:0.8em"></i></h3>

        <!-- Legal Warning -->
        <div class="legal-warning"
            style="background: rgba(255, 179, 0, 0.15); border: 1px solid rgba(255, 179, 0, 0.5); padding: 12px; margin: 10px 0; border-radius: 8px;">
            <strong style="color: var(--warning-color);">⚠️ LEGAL WARNING</strong>
            <p style="font-size: 0.85em; margin: 8px 0 0 0; color: var(--text-secondary);">
                Unauthorized WPS PIN cracking is illegal. Ensure you have permission to audit this AP.
            </p>
        </div>

        <!-- Attack Configuration -->
        <div class="attack-config" style="margin-top: 20px;">
            <h4 style="font-size: 0.85em; color: var(--accent-color); margin-bottom: 15px; font-weight: 600;">
                <i class="fas fa-cog"></i> Configuration
            </h4>

            <div class="form-group" style="margin-bottom: 12px;">
                <label style="display: block; color: #fff; font-size: 0.85em; margin-bottom: 5px;">Target BSSID:</label>
                <input type="text" id="wps-target" readonly
                    style="width: 100%; padding: 8px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: var(--text-secondary);">
            </div>

            <div class="form-group" style="margin-bottom: 12px;">
                <label style="display: block; color: #fff; font-size: 0.85em; margin-bottom: 5px;">Channel:</label>
                <input type="text" id="wps-channel" readonly
                    style="width: 100%; padding: 8px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: var(--text-secondary);">
            </div>

            <div class="form-group" style="margin-bottom: 15px;">
                <label style="display: block; color: #fff; font-size: 0.85em; margin-bottom: 5px;">Timeout
                    (Seconds):</label>
                <input type="number" id="wps-timeout" value="120" min="30" max="600"
                    style="width: 100%; padding: 8px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">
            </div>

            <button id="btn-start-wps" class="action-btn"
                style="width: 100%; margin-top: 10px; background: linear-gradient(135deg, #ffb300, #ffca28); color: black; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-weight: 700;">
                <i class="fas fa-bolt"></i> Launch Attack
            </button>
        </div>

        <!-- Active Attacks (WPS Status) -->
        <div class="active-attacks"
            style="margin-top: 25px; border-top: 1px solid var(--panel-border); padding-top: 20px;">
            <h4 style="font-size: 0.85em; color: var(--accent-color); margin-bottom: 15px; font-weight: 600;">
                <i class="fas fa-list"></i> Active Process
            </h4>
            <div id="wps-status-list" style="max-height: 300px; overflow-y: auto;">
                <div style="text-align: center; opacity: 0.6; padding: 20px; font-size: 0.85em;">
                    Ready to launch
                </div>
            </div>
        </div>
    </div>

    <!-- Auth Flood Panel -->
    <div id="auth-flood-panel" class="hud-panel wps-panel glass">
        <h3><i class="fas fa-ghost"></i> Auth Flood Attack <i class="fas fa-times" id="btn-close-auth-flood"
                style="float:right; cursor:pointer; opacity:0.6; font-size:0.8em"></i></h3>

        <div class="legal-warning"
            style="background: rgba(180, 0, 255, 0.15); border: 1px solid rgba(180, 0, 255, 0.5); padding: 12px; margin: 10px 0; border-radius: 8px;">
            <strong style="color: #c300ff;">⚠️ DOS WARNING</strong>
            <p style="font-size: 0.85em; margin: 8px 0 0 0; color: var(--text-secondary);">
                This attack floods the AP with authentication requests. (DoS)
            </p>
        </div>

        <div class="attack-config" style="margin-top: 20px;">
            <div class="form-group" style="margin-bottom: 12px;">
                <label style="display: block; color: #fff; font-size: 0.85em; margin-bottom: 5px;">Target BSSID:</label>
                <input type="text" id="auth-flood-target"
                    style="width: 100%; padding: 8px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">
            </div>

            <div class="form-group" style="margin-bottom: 12px;">
                <label style="display: block; color: #fff; font-size: 0.85em; margin-bottom: 5px;">Channel:</label>
                <input type="number" id="auth-flood-channel" placeholder="Auto"
                    style="width: 100%; padding: 8px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">
            </div>

            <div class="form-group" style="margin-bottom: 12px;">
                <label style="display: block; color: #fff; font-size: 0.85em; margin-bottom: 5px;">Packets
                    (0=Inf):</label>
                <input type="number" id="auth-flood-count" value="0"
                    style="width: 100%; padding: 8px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">
            </div>

            <button id="btn-start-auth-flood" class="action-btn"
                style="width: 100%; margin-top: 10px; background: linear-gradient(135deg, #b400ff, #e040fb); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-weight: 700;">
                <i class="fas fa-ghost"></i> FLOOD
            </button>

            <button id="btn-stop-auth-flood" class="action-btn"
                style="width: 100%; margin-top: 10px; background: var(--danger-color); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-weight: 700; display:none;">
                <i class="fas fa-stop"></i> STOP
            </button>
        </div>

        <div style="margin-top: 20px; text-align: center;">
            <div style="font-size: 0.9em; opacity: 0.8;">Status: <span id="auth-flood-status-text">Ready</span></div>
            <div style="font-size: 0.8em; opacity: 0.6;">Packets Sent: <span id="auth-flood-packets">0</span></div>
        </div>
    </div>

    <!-- Deauth Attack Panel -->
    <div id="deauth-panel" class="hud-panel deauth-panel glass">
        <h3>⚡ Deauth Attack Control <i class="fas fa-times" id="btn-close-deauth"
                style="float:right; cursor:pointer; opacity:0.6; font-size:0.8em"></i></h3>

        <!-- Legal Warning -->
        <div class="legal-warning"
            style="background: rgba(255, 59, 48, 0.15); border: 1px solid rgba(255, 59, 48, 0.5); padding: 12px; margin: 10px 0; border-radius: 8px;">
            <strong style="color: var(--danger-color);">⚠️ LEGAL WARNING</strong>
            <p style="font-size: 0.85em; margin: 8px 0 0 0; color: var(--text-secondary);">
                Unauthorized use of deauthentication attacks is illegal. Ensure proper authorization before proceeding.
            </p>
        </div>

        <!-- Attack Configuration -->
        <div class="attack-config" style="margin-top: 20px;">
            <h4 style="font-size: 0.85em; color: var(--accent-color); margin-bottom: 15px; font-weight: 600;">
                <i class="fas fa-cog"></i> Attack Configuration
            </h4>

            <div class="form-group" style="margin-bottom: 12px;">
                <label style="display: block; color: #fff; font-size: 0.85em; margin-bottom: 5px;">Interface:</label>
                <select id="deauth-interface"
                    style="width: 100%; padding: 8px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">
                    <option value="">Safe Default (Auto)</option>
                </select>
            </div>

            <div class="form-group" style="margin-bottom: 15px;">
                <label style="display: flex; align-items: center; color: #fff; font-size: 0.85em; cursor: pointer;">
                    <input type="checkbox" id="deauth-stealth" checked style="margin-right: 8px;">
                    <span style="color: #ff6b6b;">Stealth Mode (Reason Fuzzing)</span>
                </label>
            </div>

            <div style="margin-bottom: 15px; text-align: right;">
                <button id="mitm-prep-btn"
                    style="font-size: 0.75em; background: rgba(255, 179, 0, 0.15); color: #ffb300; border: 1px solid rgba(255, 179, 0, 0.3); padding: 4px 10px; border-radius: 4px; cursor: pointer;">
                    Apply MitM Prep Preset
                </button>
            </div>

            <label style="display: block; margin-top: 12px; color: #fff; font-size: 0.85em;">Target Device (AP):</label>
            <select id="deauth-target"
                style="width: 100%; padding: 8px; margin-top: 4px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">
                <option value="">-- Select Target --</option>
            </select>

            <label style="display: block; margin-top: 12px; color: #fff; font-size: 0.85em;">Target Channel:</label>
            <input type="number" id="deauth-channel" placeholder="Auto" min="1" max="177"
                style="width: 100%; padding: 8px; margin-top: 4px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">

            <label style="display: block; margin-top: 12px; color: #fff; font-size: 0.85em;">Attack Type:</label>
            <select id="deauth-type"
                style="width: 100%; padding: 8px; margin-top: 4px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">
                <option value="broadcast">Broadcast (All Clients)</option>
                <option value="unicast">Unicast (Single Client)</option>
                <option value="targeted">Targeted (Bidirectional)</option>
            </select>

            <label style="display: block; margin-top: 12px; color: #fff; font-size: 0.85em;">Client MAC (for
                unicast/targeted):</label>
            <input type="text" id="deauth-client-mac" placeholder="00:11:22:33:44:55"
                style="width: 100%; padding: 8px; margin-top: 4px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">

            <label style="display: block; margin-top: 12px; color: #fff; font-size: 0.85em;">Packet Count (0 =
                continuous):</label>
            <input type="number" id="deauth-count" value="10" min="0"
                style="width: 100%; padding: 8px; margin-top: 4px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">

            <label style="display: block; margin-top: 12px; color: #fff; font-size: 0.85em;">Interval (ms):</label>
            <input type="number" id="deauth-interval" value="100" min="10"
                style="width: 100%; padding: 8px; margin-top: 4px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">

            <label style="display: block; margin-top: 12px; color: #fff; font-size: 0.85em;">Reason Code:</label>
            <select id="deauth-reason"
                style="width: 100%; padding: 8px; margin-top: 4px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: #fff;">
                <option value="1">Unspecified</option>
                <option value="3">Deauthenticated (leaving)</option>
                <option value="6">Class 2 frame from non-auth STA</option>
                <option value="7" selected>Class 3 frame from non-assoc STA (Recommended)</option>
            </select>

            <label style="display: block; margin-top: 15px; color: #fff; font-size: 0.85em; cursor: pointer;">
                <input type="checkbox" id="deauth-legal-ack" style="margin-right: 8px;">
                I have legal authorization for this attack
            </label>

            <button id="start-deauth-btn" class="action-btn"
                style="width: 100%; margin-top: 16px; background: linear-gradient(135deg, #ff3b30, #ff6b6b); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                <i class="fas fa-bolt"></i> Start Attack
            </button>
        </div>

        <!-- Active Attacks -->
        <div class="active-attacks"
            style="margin-top: 25px; border-top: 1px solid var(--panel-border); padding-top: 20px;">
            <h4 style="font-size: 0.85em; color: var(--accent-color); margin-bottom: 15px; font-weight: 600;">
                <i class="fas fa-list"></i> Active Attacks
            </h4>
            <div id="attack-list" style="max-height: 300px; overflow-y: auto;">
                <div style="text-align: center; opacity: 0.6; padding: 20px; font-size: 0.85em;">
                    No active attacks
                </div>
            </div>
        </div>
    </div>

    <!-- Details Panel (Right Side) -->
    <div id="details-panel" class="hud-panel details-panel glass">
        <h3>Node Details <i class="fas fa-times" id="btn-close-details"
                style="float:right; cursor:pointer; opacity:0.6; font-size:0.8em"></i></h3>
        <div id="details-content">
            <!-- Content Injected via JS -->
            <div style="text-align:center; opacity:0.6; padding:20px;">
                Select a node to view details
            </div>
        </div>
    </div>

    <!-- Console Panel (Bottom Sheet) -->
    <div id="console-panel">
        <div class="drag-handle"></div>
        <div class="console-header" id="console-toggle">
            <div class="console-title">
                <i class="fas fa-terminal" style="color:var(--accent-color)"></i> Console <span
                    id="console-indicator"></span>
            </div>
            <div class="console-actions">
                <button class="console-btn" id="console-clear" title="Clear Logs"><i
                        class="fas fa-trash-alt"></i></button>
                <button class="console-btn" title="Filter"><i class="fas fa-filter"></i></button>
                <button class="console-btn" title="Toggle"><i class="fas fa-chevron-up"></i></button>
            </div>
        </div>
        <div id="console-list">
            <!-- Logs go here -->
            <div class="console-entry entry-system" style="opacity:0.5; font-style:italic;">
                <span class="entry-time">--:--:--</span>
                <span class="entry-icon"><i class="fas fa-power-off"></i></span>
                <span class="entry-msg">System Ready.</span>
            </div>
        </div>
    </div>

</body>

</html>