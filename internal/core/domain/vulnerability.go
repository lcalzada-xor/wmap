package domain

import "time"

// VulnerabilityTag represents a detected vulnerability with confidence scoring
type VulnerabilityTag struct {
	Name        string    `json:"name"`       // "WEP", "WPS", "KRACK", etc.
	Severity    int       `json:"severity"`   // 1-10 scale
	Confidence  float64   `json:"confidence"` // 0.0-1.0 (0.0=inferred, 1.0=confirmed)
	Evidence    []string  `json:"evidence"`   // List of evidence supporting detection
	DetectedAt  time.Time `json:"detected_at"`
	Category    string    `json:"category"`    // "protocol", "configuration", "behavior"
	Description string    `json:"description"` // Human-readable description
	Mitigation  string    `json:"mitigation"`  // Suggested remediation
}

// VulnerabilityLevel represents confidence levels
const (
	ConfidenceConfirmed   = 1.0 // Direct evidence in packets
	ConfidenceHigh        = 0.8 // Strong indicators
	ConfidenceMedium      = 0.5 // Reasonable inference
	ConfidenceLow         = 0.3 // Weak inference
	ConfidenceSpeculative = 0.1 // Pure speculation
)

// Severity levels
const (
	VulnSeverityCritical = 10
	VulnSeverityHigh     = 8
	VulnSeverityMedium   = 5
	VulnSeverityLow      = 3
	VulnSeverityInfo     = 1
)
